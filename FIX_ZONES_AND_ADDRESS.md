# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–æ–Ω –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –û—à–∏–±–∫–∞ 403 –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω—ã

### –ü—Ä–æ–±–ª–µ–º–∞
`GET /api/zones/active` –≤–æ–∑–≤—Ä–∞—â–∞–ª 403 Forbidden, —Ö–æ—Ç—è –Ω–µ –¥–æ–ª–∂–µ–Ω —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

### –ü—Ä–∏—á–∏–Ω–∞
–í `SecurityConfig` –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∫—Ä–æ–º–µ `/api/auth/**` —Ç—Ä–µ–±–æ–≤–∞–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é. –≠–Ω–¥–ø–æ–∏–Ω—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∑–æ–Ω—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º.

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω—ã:

```java
.requestMatchers("/api/zones/active").permitAll() // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω—ã - –ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
```

### –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
```
GET /api/zones/active
‚Üí 200 OK (–µ—Å–ª–∏ –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞)
‚Üí 404 Not Found (–µ—Å–ª–∏ –∑–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)
```

**–ó–∞–≥–æ–ª–æ–≤–æ–∫ `X-User-Id` –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!**

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –†–∞–±–æ—Ç–∞ —Å –∞–¥—Ä–µ—Å–æ–º –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–°–∏—Å—Ç–µ–º–∞ **–º–æ–∂–µ—Ç** –±—Ä–∞—Ç—å –∞–¥—Ä–µ—Å –∏–∑ –∑–∞–∫–∞–∑–∞ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω—ã:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –° –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚úÖ

**–ó–∞–ø—Ä–æ—Å:**
```json
{
    "address": "–≥. –û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "pickupTime": "2025-01-20T14:00:00+03:00",
    "lat": 51.7687,
    "lng": 55.1017
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã `lat` –∏ `lng`
2. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–∞—è –∑–æ–Ω–∞ –∏–∑ –ë–î
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ç–æ—á–∫–∞ (lat, lng) –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª–∏–≥–æ–Ω–∞ –∑–æ–Ω—ã
4. –ï—Å–ª–∏ –¥–∞ ‚Üí –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è ‚úÖ
5. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –æ—à–∏–±–∫–∞ "–ê–¥—Ä–µ—Å –≤–Ω–µ –∑–æ–Ω—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è" ‚ùå

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ—Ç–æ—á–Ω–æ) ‚ö†Ô∏è

**–ó–∞–ø—Ä–æ—Å:**
```json
{
    "address": "–≥. –û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "pickupTime": "2025-01-20T14:00:00+03:00"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ê–¥—Ä–µ—Å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `GeocodingService.getCoordinates(address)`
2. **–í MVP:** `GeocodingService` - –∑–∞–≥–ª—É—à–∫–∞, –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞ (51.7687, 55.1017)
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞ –≤ –∑–æ–Ω–µ
4. –ï—Å–ª–∏ –∑–æ–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä ‚Üí –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è ‚úÖ
5. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –æ—à–∏–±–∫–∞ ‚ùå

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –í MVP –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞, –ø–æ—ç—Ç–æ–º—É —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è.

---

## üìä –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥—Ä–µ—Å–∞

```
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    ‚Üì
–ü–µ—Ä–µ–¥–∞–Ω—ã lat –∏ lng?
    ‚îú‚îÄ –î–∞ ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    ‚îÇ        ‚Üì
    ‚îÇ   –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∑–æ–Ω—É
    ‚îÇ        ‚Üì
    ‚îÇ   –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∑–æ–Ω—ã –≤ –ø–æ–ª–∏–≥–æ–Ω
    ‚îÇ        ‚Üì
    ‚îÇ   GeoUtils.isPointInPolygon(point, polygon)
    ‚îÇ        ‚Üì
    ‚îÇ   –¢–æ—á–∫–∞ –≤ –ø–æ–ª–∏–≥–æ–Ω–µ?
    ‚îÇ        ‚îú‚îÄ –î–∞ ‚Üí –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω ‚úÖ
    ‚îÇ        ‚îî‚îÄ –ù–µ—Ç ‚Üí –û—à–∏–±–∫–∞ "–ê–¥—Ä–µ—Å –≤–Ω–µ –∑–æ–Ω—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è" ‚ùå
    ‚îÇ
    ‚îî‚îÄ –ù–µ—Ç ‚Üí GeocodingService.getCoordinates(address)
              ‚Üì
         (–í MVP: –≤—Å–µ–≥–¥–∞ —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞ 51.7687, 55.1017)
              ‚Üì
         –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—ã—à–µ
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

**–ü–æ—á–µ–º—É:**
- –¢–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–µ–æ–∫–æ–¥–µ—Ä–∞
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –≥–µ–æ–∫–æ–¥–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –í MVP –≥–µ–æ–∫–æ–¥–µ—Ä - –∑–∞–≥–ª—É—à–∫–∞

**–ü—Ä–∏–º–µ—Ä:**
```json
{
    "address": "–≥. –û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "pickupTime": "2025-01-20T14:00:00+03:00",
    "lat": 51.7750,  // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∑–æ–Ω—ã
    "lng": 55.1100
}
```

### ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

–í MVP –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –±—É–¥—É—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞ (51.7687, 55.1017), –ø–æ—ç—Ç–æ–º—É:
- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∑–æ–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞
- –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∏–∑–∫–∞—è
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º –≥–µ–æ–∫–æ–¥–µ—Ä–æ–º

---

## üîç –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞–∫–∞–∑ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

```json
POST /api/orders
Headers:
  X-User-Id: 1
  Content-Type: application/json
Body:
{
    "address": "–≥. –û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "pickupTime": "2025-01-20T14:00:00+03:00",
    "lat": 51.7750,
    "lng": 55.1100
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (51.7750, 55.1100) –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ –≤ –∑–æ–Ω–µ ‚Üí –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω ‚úÖ
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ –≤–Ω–µ –∑–æ–Ω—ã ‚Üí –æ—à–∏–±–∫–∞ ‚ùå

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–∫–∞–∑ –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ—Ç–æ—á–Ω–æ)

```json
POST /api/orders
Headers:
  X-User-Id: 1
  Content-Type: application/json
Body:
{
    "address": "–≥. –û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "pickupTime": "2025-01-20T14:00:00+03:00"
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ê–¥—Ä–µ—Å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞ (51.7687, 55.1017)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞
- –ï—Å–ª–∏ –∑–æ–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä ‚Üí –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω ‚úÖ
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –æ—à–∏–±–∫–∞ ‚ùå

---

## üöÄ –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º –≥–µ–æ–∫–æ–¥–µ—Ä–æ–º

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å:

1. **–Ø–Ω–¥–µ–∫—Å.–ì–µ–æ–∫–æ–¥–µ—Ä** (–¥–ª—è –†–æ—Å—Å–∏–∏)
   - API: https://yandex.ru/dev/geocoder/
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ: 25,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å

2. **Google Geocoding API**
   - –¢–æ—á–Ω—ã–π, –Ω–æ –ø–ª–∞—Ç–Ω—ã–π

3. **OpenStreetMap Nominatim**
   - –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

–ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞ –±—É–¥—É—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

---

## ‚úÖ –ò—Ç–æ–≥

1. ‚úÖ **–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–æ–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** - —Ç–µ–ø–µ—Ä—å –ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–ª–∏ –≥–µ–æ–∫–æ–¥–µ—Ä
3. ‚ö†Ô∏è **–í MVP –≥–µ–æ–∫–æ–¥–µ—Ä - –∑–∞–≥–ª—É—à–∫–∞** - –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–Ω—Ç—Ä –û—Ä–µ–Ω–±—É—Ä–≥–∞
4. ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã** –¥–ª—è —Ç–æ—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

---

**–¢–µ–ø–µ—Ä—å –≤—Å–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å!** üéâ

–°–º. —Ç–∞–∫–∂–µ: `ADDRESS_VALIDATION_INFO.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏








