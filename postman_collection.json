{
	"info": {
		"_postman_id": "musor-service-api-v2",
		"name": "Musor Service API - Complete Collection",
		"description": "Полная коллекция для тестирования API сервиса вывоза мусора. Включает все эндпоинты: аутентификация, пользователи, заказы, подписки, зоны обслуживания.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Auth - Аутентификация",
			"item": [
				{
					"name": "Регистрация (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"name\": \"Иван Иванов\",\n    \"role\": \"CLIENT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						},
						"description": "Регистрация нового клиента. Роли: CLIENT, COURIER, ADMIN"
					},
					"response": []
				},
				{
					"name": "Регистрация (COURIER)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79059876543\",\n    \"name\": \"Петр Петров\",\n    \"role\": \"COURIER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					},
					"response": []
				},
				{
					"name": "Регистрация (ADMIN)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79055555555\",\n    \"name\": \"Администратор\",\n    \"role\": \"ADMIN\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					},
					"response": []
				},
				{
					"name": "Отправить OTP код",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/send-code",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "send-code"]
						},
						"description": "Отправка OTP кода на телефон. В MVP код возвращается в ответе для тестирования."
					},
					"response": []
				},
				{
					"name": "Вход (с OTP кодом)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"code\": \"{{otpCode}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						},
						"description": "Вход с OTP кодом. Также работает фиксированный код \"0000\" для обратной совместимости."
					},
					"response": []
				},
				{
					"name": "Вход (фиксированный код 0000)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"code\": \"0000\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Users - Пользователи",
			"item": [
				{
					"name": "Получить профиль",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/me",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "me"]
						},
						"description": "Получение профиля текущего пользователя"
					},
					"response": []
				},
				{
					"name": "Обновить имя",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Иван Петров\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/me/name",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "me", "name"]
						},
						"description": "Обновление имени пользователя. Валидация: 2-50 символов, только буквы, пробелы и дефис."
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Zones - Зоны обслуживания",
			"item": [
				{
					"name": "Получить активную зону (публичный)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/zones/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "zones", "active"]
						},
						"description": "Получение активной зоны обслуживания. Публичный эндпоинт, не требует заголовка X-User-Id."
					},
					"response": []
				},
				{
					"name": "Создать/установить активную зону (ADMIN)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{adminUserId}}",
								"description": "ID администратора"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Оренбург\",\n    \"coordinates\": [\n        {\"lat\": 51.7687, \"lng\": 55.1017},\n        {\"lat\": 51.7887, \"lng\": 55.1017},\n        {\"lat\": 51.7887, \"lng\": 55.1217},\n        {\"lat\": 51.7687, \"lng\": 55.1217}\n    ]\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/zones",
							"host": ["{{baseUrl}}"],
							"path": ["api", "zones"]
						},
						"description": "Создание или обновление активной зоны обслуживания. Только для ADMIN. При создании новой зоны все предыдущие автоматически деактивируются."
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Orders - Заказы",
			"item": [
				{
					"name": "Создать разовой заказ (только адрес)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"address\": \"Оренбург, ул. Ленина, д. 10\",\n    \"pickupTime\": \"2025-01-20T14:00:00+03:00\",\n    \"comment\": \"Домофон не работает, звоните по телефону\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Создание разового заказа только с адресом. Адрес автоматически преобразуется в координаты через Яндекс.Геокодер и проверяется на вхождение в активную зону."
					},
					"response": []
				},
				{
					"name": "Создать разовой заказ (адрес + координаты)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"address\": \"Оренбург, ул. Ленина, д. 10\",\n    \"pickupTime\": \"2025-01-20T15:00:00+03:00\",\n    \"comment\": \"Позвонить за час\",\n    \"lat\": 51.7750,\n    \"lng\": 55.1100\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Создание разового заказа с адресом и координатами. Если координаты переданы, геокодер не вызывается (экономия запросов)."
					},
					"response": []
				},
				{
					"name": "Создать заказ по подписке",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"address\": \"Оренбург, ул. Ленина, д. 10\",\n    \"pickupTime\": \"2025-01-21T10:00:00+03:00\",\n    \"comment\": \"У двери\",\n    \"subscriptionId\": {{subscriptionId}}\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Создание заказа по активной подписке. Подписка должна быть активна (ACTIVE)."
					},
					"response": []
				},
				{
					"name": "Получить список заказов (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Получение всех заказов текущего клиента"
					},
					"response": []
				},
				{
					"name": "Получить доступные заказы (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/available",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "available"]
						},
						"description": "Получение свободных заказов для курьера (статус PUBLISHED, без курьера). Поле isAvailable = true."
					},
					"response": []
				},
				{
					"name": "Получить активные заказы (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "active"]
						},
						"description": "Получение активных заказов курьера (ACCEPTED, ON_THE_WAY, PICKED_UP). Поле isAvailable = false."
					},
					"response": []
				},
				{
					"name": "Получить статистику заказов (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "stats"]
						},
						"description": "Получение статистики: количество доступных и активных заказов"
					},
					"response": []
				},
				{
					"name": "Получить заказ по ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}"]
						},
						"description": "Получение заказа по ID"
					},
					"response": []
				},
				{
					"name": "Отменить заказ (CLIENT)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/cancel",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "cancel"]
						},
						"description": "Отмена заказа клиентом. Можно отменить только свои заказы со статусом PUBLISHED."
					},
					"response": []
				},
				{
					"name": "Принять заказ (COURIER)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/accept",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "accept"]
						},
						"description": "Принятие заказа курьером. Можно принять только заказы со статусом PUBLISHED."
					},
					"response": []
				},
				{
					"name": "Обновить статус заказа (COURIER)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"status\": \"ON_THE_WAY\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/status",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "status"]
						},
						"description": "Обновление статуса заказа курьером. Доступные статусы: ON_THE_WAY, PICKED_UP, COMPLETED, CANCELLED_BY_COURIER"
					},
					"response": []
				},
				{
					"name": "Обновить статус заказа (ADMIN)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{adminUserId}}",
								"description": "ID администратора"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"status\": \"COMPLETED\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders/admin/{{orderId}}/status",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "admin", "{{orderId}}", "status"]
						},
						"description": "Ручное обновление статуса заказа администратором. Доступные статусы: PUBLISHED, ACCEPTED, ON_THE_WAY, PICKED_UP, COMPLETED, CANCELLED_BY_CUSTOMER, CANCELLED_BY_COURIER"
					},
					"response": []
				}
			]
		},
		{
			"name": "5. Subscriptions - Подписки",
			"item": [
				{
					"name": "Создать подписку (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"plan\": \"MONTHLY\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions"]
						},
						"description": "Создание новой подписки. Планы: WEEKLY, MONTHLY"
					},
					"response": []
				},
				{
					"name": "Получить все подписки (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions"]
						},
						"description": "Получение всех подписок текущего пользователя"
					},
					"response": []
				},
				{
					"name": "Получить активные подписки (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "active"]
						},
						"description": "Получение только активных и не истекших подписок"
					},
					"response": []
				},
				{
					"name": "Отменить подписку (CLIENT)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}"]
						},
						"description": "Отмена подписки. Подписка получает статус CANCELED."
					},
					"response": []
				},
				{
					"name": "Приостановить подписку (CLIENT)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}/pause",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}", "pause"]
						},
						"description": "Приостановка активной подписки. Подписка получает статус PAUSED."
					},
					"response": []
				},
				{
					"name": "Возобновить подписку (CLIENT)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}/resume",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}", "resume"]
						},
						"description": "Возобновление приостановленной подписки. Подписка получает статус ACTIVE."
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "clientUserId",
			"value": "1",
			"type": "string",
			"description": "ID клиента (получить после регистрации)"
		},
		{
			"key": "courierUserId",
			"value": "2",
			"type": "string",
			"description": "ID курьера (получить после регистрации)"
		},
		{
			"key": "adminUserId",
			"value": "3",
			"type": "string",
			"description": "ID администратора (получить после регистрации)"
		},
		{
			"key": "orderId",
			"value": "1",
			"type": "string",
			"description": "ID заказа (получить после создания заказа)"
		},
		{
			"key": "subscriptionId",
			"value": "1",
			"type": "string",
			"description": "ID подписки (получить после создания подписки)"
		},
		{
			"key": "otpCode",
			"value": "",
			"type": "string",
			"description": "OTP код (получить из ответа /api/auth/send-code)"
		}
	]
}
