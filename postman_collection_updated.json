{
	"info": {
		"_postman_id": "musor-service-api",
		"name": "Musor Service API - Complete",
		"description": "Полная коллекция для тестирования API сервиса вывоза мусора со всеми новыми эндпоинтами",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Auth",
			"item": [
				{
					"name": "Регистрация (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"name\": \"Иван Иванов\",\n    \"role\": \"CLIENT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					},
					"response": []
				},
				{
					"name": "Регистрация (COURIER)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79059876543\",\n    \"name\": \"Петр Петров\",\n    \"role\": \"COURIER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "register"]
						}
					},
					"response": []
				},
				{
					"name": "Отправить OTP код",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/send-code",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "send-code"]
						},
						"description": "Отправка OTP кода на телефон. В MVP код возвращается в ответе."
					},
					"response": []
				},
				{
					"name": "Вход (с OTP)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"code\": \"{{otpCode}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						},
						"description": "Вход с OTP кодом. Также работает фиксированный код \"0000\"."
					},
					"response": []
				},
				{
					"name": "Вход (фиксированный код 0000)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"phone\": \"+79051234567\",\n    \"code\": \"0000\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["api", "auth", "login"]
						},
						"description": "Вход с фиксированным кодом (обратная совместимость)"
					},
					"response": []
				}
			]
		},
		{
			"name": "Users",
			"item": [
				{
					"name": "Получить профиль",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/me",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "me"]
						},
						"description": "Получение профиля текущего пользователя"
					},
					"response": []
				},
				{
					"name": "Обновить имя",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Иван Петров\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/me/name",
							"host": ["{{baseUrl}}"],
							"path": ["api", "users", "me", "name"]
						},
						"description": "Обновление имени пользователя. Валидация: 2-50 символов, только буквы, пробелы и дефис."
					},
					"response": []
				}
			]
		},
		{
			"name": "Zones",
			"item": [
				{
					"name": "Получить активную зону",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/zones/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "zones", "active"]
						}
					},
					"response": []
				},
				{
					"name": "Создать/установить активную зону (ADMIN)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{adminUserId}}",
								"description": "ID администратора"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Оренбург\",\n    \"coordinates\": [\n        {\"lat\": 51.7687, \"lng\": 55.1017},\n        {\"lat\": 51.7887, \"lng\": 55.1017},\n        {\"lat\": 51.7887, \"lng\": 55.1217},\n        {\"lat\": 51.7687, \"lng\": 55.1217}\n    ]\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/zones",
							"host": ["{{baseUrl}}"],
							"path": ["api", "zones"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders",
			"item": [
				{
					"name": "Создать разовой заказ (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"address\": \"г. Оренбург, ул. Ленина, д. 1, подъезд 3\",\n    \"pickupTime\": \"2025-01-20T14:00:00+03:00\",\n    \"comment\": \"Домофон не работает, звоните по телефону\",\n    \"lat\": 51.7687,\n    \"lng\": 55.1017\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						}
					},
					"response": []
				},
				{
					"name": "Создать заказ по подписке (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"address\": \"г. Оренбург, ул. Ленина, д. 2\",\n    \"pickupTime\": \"2025-01-21T10:00:00+03:00\",\n    \"comment\": \"У двери\",\n    \"subscriptionId\": {{subscriptionId}},\n    \"lat\": 51.7687,\n    \"lng\": 55.1017\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						}
					},
					"response": []
				},
				{
					"name": "Получить список заказов (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						}
					},
					"response": []
				},
				{
					"name": "Получить свободные заказы (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/available",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "available"]
						},
						"description": "Возвращает только свободные заказы (PUBLISHED, без курьера). Поле isAvailable = true."
					},
					"response": []
				},
				{
					"name": "Получить активные заказы (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "active"]
						},
						"description": "Возвращает активные заказы курьера (ACCEPTED, ON_THE_WAY, PICKED_UP). Поле isAvailable = false."
					},
					"response": []
				},
				{
					"name": "Получить статистику заказов (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/stats",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "stats"]
						},
						"description": "Возвращает количество свободных и активных заказов"
					},
					"response": []
				},
				{
					"name": "Получить список заказов (COURIER)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						},
						"description": "Возвращает объединенный список (свободные + активные). Рекомендуется использовать /available и /active."
					},
					"response": []
				},
				{
					"name": "Получить список заказов (ADMIN)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{adminUserId}}",
								"description": "ID администратора"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders"]
						}
					},
					"response": []
				},
				{
					"name": "Получить заказ по ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID пользователя"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}"]
						}
					},
					"response": []
				},
				{
					"name": "Отменить заказ (CLIENT)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/cancel",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "cancel"]
						}
					},
					"response": []
				},
				{
					"name": "Принять заказ (COURIER)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/accept",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "accept"]
						}
					},
					"response": []
				},
				{
					"name": "Обновить статус заказа (COURIER)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{courierUserId}}",
								"description": "ID курьера"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"status\": \"ON_THE_WAY\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders/{{orderId}}/status",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "{{orderId}}", "status"]
						},
						"description": "Доступные статусы: ON_THE_WAY, PICKED_UP, COMPLETED, CANCELLED_BY_COURIER"
					},
					"response": []
				},
				{
					"name": "Обновить статус заказа (ADMIN)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{adminUserId}}",
								"description": "ID администратора"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"status\": \"COMPLETED\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/orders/admin/{{orderId}}/status",
							"host": ["{{baseUrl}}"],
							"path": ["api", "orders", "admin", "{{orderId}}", "status"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Subscriptions",
			"item": [
				{
					"name": "Создать подписку (CLIENT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"plan\": \"WEEKLY\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions"]
						},
						"description": "Планы: WEEKLY, MONTHLY"
					},
					"response": []
				},
				{
					"name": "Получить все подписки (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions"]
						}
					},
					"response": []
				},
				{
					"name": "Получить активные подписки (CLIENT)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/active",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "active"]
						},
						"description": "Возвращает только активные и не истекшие подписки"
					},
					"response": []
				},
				{
					"name": "Отменить подписку (CLIENT)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}"]
						}
					},
					"response": []
				},
				{
					"name": "Приостановить подписку (CLIENT)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}/pause",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}", "pause"]
						}
					},
					"response": []
				},
				{
					"name": "Возобновить подписку (CLIENT)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{clientUserId}}",
								"description": "ID клиента"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/subscriptions/{{subscriptionId}}/resume",
							"host": ["{{baseUrl}}"],
							"path": ["api", "subscriptions", "{{subscriptionId}}", "resume"]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		},
		{
			"key": "clientUserId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "courierUserId",
			"value": "2",
			"type": "string"
		},
		{
			"key": "adminUserId",
			"value": "3",
			"type": "string"
		},
		{
			"key": "orderId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "subscriptionId",
			"value": "1",
			"type": "string"
		},
		{
			"key": "otpCode",
			"value": "",
			"type": "string"
		}
	]
}

