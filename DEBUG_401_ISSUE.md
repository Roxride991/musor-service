# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–∫–∏ 401

## –ü—Ä–æ–±–ª–µ–º–∞

–í Postman –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-User-Id` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "–¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ X-User-Id".

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Backend

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Backend. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∏:

```
INFO HeaderAuthenticationFilter: Request to /api/orders
INFO HeaderAuthenticationFilter: All headers:
  Content-Type = application/json
  X-User-Id = 1
  ...
INFO HeaderAuthenticationFilter: X-User-Id header value: '1' (length: 1)
```

**–ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –≤–∏–¥–µ–Ω –≤ –ª–æ–≥–∞—Ö:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ Postman (–∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è)
- –ò–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `{{clientUserId}}`

**–ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–¥–µ–Ω, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID 1 –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
- –ù—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ Postman

1. –í Postman –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Variables"
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `clientUserId` = `1` (–∏–ª–∏ –¥—Ä—É–≥–æ–π ID)

**–ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∑–∞–ø—Ä–æ—Å–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–ø—Ä–æ—Å
2. –í –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ "Variables in request" –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   - `clientUserId` = `1`

---

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```
POST http://localhost:8080/api/auth/register
Content-Type: application/json

{
    "phone": "+79051111111",
    "name": "–¢–µ—Å—Ç–æ–≤—ã–π –ö–ª–∏–µ–Ω—Ç",
    "role": "CLIENT"
}
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ `id` –∏–∑ –æ—Ç–≤–µ—Ç–∞!**

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î**

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –±—ã–ª –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –µ–≥–æ ID –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

---

### 4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ

–í–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `{{clientUserId}}` –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —É–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é:

1. –í Postman –æ—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–ø—Ä–æ—Å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Headers"
3. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `X-User-Id` —Å `{{clientUserId}}` –Ω–∞ `1` (–∏–ª–∏ –¥—Ä—É–≥–æ–π ID)

---

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
- `X-User-Id` (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
- `x-user-id` (–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
- `X-USER-ID` (–º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)

–§–∏–ª—å—Ç—Ä —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `X-User-Id`.

---

## –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –¢–µ—Å—Ç 1: –ü—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫):

```
GET http://localhost:8080/api/zones/active
```

–î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-User-Id`.

### –¢–µ—Å—Ç 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```
POST http://localhost:8080/api/auth/register
Content-Type: application/json

{
    "phone": "+79051111111",
    "name": "–¢–µ—Å—Ç",
    "role": "CLIENT"
}
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ `id` –∏–∑ –æ—Ç–≤–µ—Ç–∞.

### –¢–µ—Å—Ç 3: –ó–∞–ø—Ä–æ—Å —Å –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–º ID

```
POST http://localhost:8080/api/orders
Headers:
  Content-Type: application/json
  X-User-Id: 1    ‚Üê –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
Body:
{
    "address": "–û—Ä–µ–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10",
    "pickupTime": "2025-01-20T14:00:00+03:00"
}
```

---

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Backend** - —Ç–∞–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç –≤ –ë–î
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** - –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —Ç–µ—Å—Ç–∞
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Postman** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

---

## –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ

```
INFO HeaderAuthenticationFilter: Request to /api/orders
INFO HeaderAuthenticationFilter: All headers:
  Content-Type = application/json
  X-User-Id = 1
  ...
INFO HeaderAuthenticationFilter: X-User-Id header value: '1' (length: 1)
INFO HeaderAuthenticationFilter: ‚úÖ Authentication set for user ID: 1 (role: CLIENT)
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–∏ –ª–æ–≥–∏, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç–µ 401 - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ.







